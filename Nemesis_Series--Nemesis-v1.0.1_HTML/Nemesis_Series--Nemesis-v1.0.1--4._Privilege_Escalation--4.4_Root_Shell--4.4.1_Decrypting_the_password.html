<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.4.1 Decrypting the password</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">4.4.1 Decrypting the password</h1><br/><br />After watching the code we can see the following:<br /><br />• To decrypt the password, we need a key pair. <br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">def</span>&nbsp;affine_decrypt(cipher,&nbsp;key):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">return</span>&nbsp;<span style="color:#ff00ff;font-weight:400">''</span>.join([&nbsp;<span style="color:#008a8c;font-weight:400">chr</span>(((&nbsp;modinv(key[<span style="color:#ff00ff;font-weight:400">0</span>],&nbsp;<span style="color:#ff00ff;font-weight:400">26</span>)*(<span style="color:#008a8c;font-weight:400">ord</span>(c)&nbsp;-&nbsp;<span style="color:#008a8c;font-weight:400">ord</span>(<span style="color:#ff00ff;font-weight:400">'A'</span>)&nbsp;-&nbsp;key[<span style="color:#ff00ff;font-weight:400">1</span>]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%&nbsp;<span style="color:#ff00ff;font-weight:400">26</span>)&nbsp;+&nbsp;<span style="color:#008a8c;font-weight:400">ord</span>(<span style="color:#ff00ff;font-weight:400">'A'</span>))&nbsp;<span style="color:#a52a2a;font-weight:700">for</span>&nbsp;c&nbsp;<span style="color:#a52a2a;font-weight:700">in</span>&nbsp;cipher&nbsp;])<br /></div></div><br /><br />• We know that the password contains the word "FUN". <br /><br />We can use the following script to get the key pair:<br /><br />     <div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;sys<br /><span style="color:#a52a2a;font-weight:700">def</span>&nbsp;affine_encrypt(text,&nbsp;key):<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">return</span>&nbsp;<span style="color:#ff00ff;font-weight:400">''</span>.join([&nbsp;<span style="color:#008a8c;font-weight:400">chr</span>(((&nbsp;key[<span style="color:#ff00ff;font-weight:400">0</span>]*(<span style="color:#008a8c;font-weight:400">ord</span>(t)&nbsp;-&nbsp;<span style="color:#008a8c;font-weight:400">ord</span>(<span style="color:#ff00ff;font-weight:400">'A'</span>))&nbsp;+&nbsp;key[<span style="color:#ff00ff;font-weight:400">1</span>]&nbsp;)&nbsp;%&nbsp;<span style="color:#ff00ff;font-weight:400">26</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span style="color:#008a8c;font-weight:400">ord</span>(<span style="color:#ff00ff;font-weight:400">'A'</span>))&nbsp;<span style="color:#a52a2a;font-weight:700">for</span>&nbsp;t&nbsp;<span style="color:#a52a2a;font-weight:700">in</span>&nbsp;text.upper().replace(<span style="color:#ff00ff;font-weight:400">'&nbsp;'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">''</span>)&nbsp;])<br /><span style="color:#a52a2a;font-weight:700">if</span>&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;affine_text=<span style="color:#ff00ff;font-weight:400">"FUN"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">for</span>&nbsp;key0&nbsp;<span style="color:#a52a2a;font-weight:700">in</span>&nbsp;<span style="color:#008a8c;font-weight:400">range</span>(<span style="color:#ff00ff;font-weight:400">65</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">91</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">for</span>&nbsp;key1&nbsp;<span style="color:#a52a2a;font-weight:700">in</span>&nbsp;<span style="color:#008a8c;font-weight:400">range</span>(<span style="color:#ff00ff;font-weight:400">65</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">91</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encrypt_text&nbsp;=&nbsp;affine_encrypt(affine_text,&nbsp;[key0,&nbsp;key1])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">if</span>&nbsp;encrypt_text&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">"QZA"</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">print</span>(key0,key1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit(<span style="color:#ff00ff;font-weight:400">0</span>)</div></div><br /><br />So, let's do it.<br /><br />a) Create a file called “key.py” with the code above.<br /><br />b) Run the file.<br /><br />    <div class="codebox"><div class="codebox">$&nbsp;python&nbsp;key.py</div></div><br /><br />    <span style="color:#ffa500;background-color:#ffffff;">Output:</span><br />    <span style="color:#000000;background-color:#000000;">(89, 65)</span><br /><br />c) Create a script to decrypt the file. Save it as “decrypt.py”.<br /><br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">def</span>&nbsp;affine_decrypt(cipher):<br />&nbsp;&nbsp;&nbsp;&nbsp;text&nbsp;=&nbsp;[]<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">for</span>&nbsp;t&nbsp;<span style="color:#a52a2a;font-weight:700">in</span>&nbsp;cipher:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">ord</span>(t)&nbsp;-&nbsp;<span style="color:#008a8c;font-weight:400">ord</span>(<span style="color:#ff00ff;font-weight:400">'A'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">for</span>&nbsp;x&nbsp;<span style="color:#a52a2a;font-weight:700">in</span>&nbsp;<span style="color:#008a8c;font-weight:400">range</span>(<span style="color:#ff00ff;font-weight:400">0</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">26</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;(<span style="color:#ff00ff;font-weight:400">65</span>&nbsp;+&nbsp;x*<span style="color:#ff00ff;font-weight:400">89</span>&nbsp;-&nbsp;b)&nbsp;%&nbsp;<span style="color:#ff00ff;font-weight:400">26</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">if</span>&nbsp;result&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">0</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text.append(<span style="color:#008a8c;font-weight:400">chr</span>(x&nbsp;+&nbsp;<span style="color:#008a8c;font-weight:400">ord</span>(<span style="color:#ff00ff;font-weight:400">'A'</span>)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">break</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">print</span>(<span style="color:#ff00ff;font-weight:400">''</span>.join(text))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color:#a52a2a;font-weight:700">if</span>&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;affine_encrypted_text&nbsp;=&nbsp;<span style="color:#ff00ff;font-weight:400">"FAJSRWOXLAXDQZAWNDDVLSU"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;affine_decrypt(affine_encrypted_text)</div></div><br /><br />d) Run the file.<br /><br />    <div class="codebox"><div class="codebox">$&nbsp;python&nbsp;decrypt.py</div></div><br /><br />    <span style="color:#ffa500;background-color:#ffffff;">Output:</span><br />    <span style="color:#000000;background-color:#000000;">ENCRYPTIONISFUNPASSWORD</span><br /><br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>