<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>3.1 Gobuster</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>3.1 Gobuster</h1><br/><p></p><p>1. Run “gobuster” to enumerate the victim&#39;s machine.</p><p>    <div class="codebox"><pre>$ gobuster <span style="color:#a52a2a;font-weight:700">dir</span> -e -w <span style="color:#a52a2a;font-weight:700">/</span>usr<span style="color:#a52a2a;font-weight:700">/</span>share<span style="color:#a52a2a;font-weight:700">/</span>wordlists<span style="color:#a52a2a;font-weight:700">/</span>dirb<span style="color:#a52a2a;font-weight:700">/</span>big.txt -x php, jpg -t 40 -u http<span style="color:#a52a2a;font-weight:700">://</span>192.168.12.70 <span style="color:#a52a2a;font-weight:700">|</span> <span style="color:#a52a2a;font-weight:700">tee</span> gobuster_discover.log</pre></div></p><p></p><p>    <span style="color:#ffa500;">Output:</span></p><p>    <img src="images/1071-1.png" alt="images/1071-1.png" /></p><p>    </p><p>    You can see all the responses returns a 403 code. Maybe there&#39;s a <a href="https://en.wikipedia.org/wiki/Web_application_firewall">WAF</a>.</p><p>    </p><p>    The easiest way of knowing whether there is a WAF or not is with the tool “whatwaf”. To install it and more info you can visit <code><a href="https://github.com/ekultek/whatwaf">https://github.com/ekultek/whatwaf</a></code>.</p><p></p><p></p><p>2. Run “whatwaf”.</p><p>    <div class="codebox"><pre>$ .<span style="color:#a52a2a;font-weight:700">/</span>whatwaf -u http<span style="color:#a52a2a;font-weight:700">://</span>192.168.12.70<br /></pre></div></p><p></p><p>    <span style="color:#ffa500;">Output:</span></p><p>    <img src="images/1071-2.png" alt="images/1071-2.png" /></p><p>    </p><p>    The firewall is “Apache”.</p><p>    </p><p>    The web server has a WAF that responses a 403 error if maximum of &quot;not found requests&quot; per minute is overpassed.</p><p> </p><p><em><span style="indent:1;">HTTP 403 is an HTTP status code meaning access to the requested resource is forbidden. The server understood the  request, but will not fulfill it.</span></em></p><p>        </p><p>3. Run “gobuster” again but this time slower with the parameters <span style="background-color:#c0c0c0;">--delay s1</span> and <span style="background-color:#c0c0c0;">-t 1</span>. (Have a coffee or more)</p><p>   <div class="codebox"><pre>$ gobuster -q <span style="color:#a52a2a;font-weight:700">dir</span> -w <span style="color:#a52a2a;font-weight:700">/</span>usr<span style="color:#a52a2a;font-weight:700">/</span>share<span style="color:#a52a2a;font-weight:700">/</span>wordlists<span style="color:#a52a2a;font-weight:700">/</span>dirbuster<span style="color:#a52a2a;font-weight:700">/</span>directory-list-2.3-medium.txt -x php -u http<span style="color:#a52a2a;font-weight:700">://</span>192.168.12.70 --delay 1s -t 1</pre></div>     </p><p></p><p>    <span style="color:#ffa500;">Output:</span></p><p>    <img src="images/1071-3.png" alt="images/1071-3.png" /></p><p>    </p><p>    Now there isn&#39;t 403 responses and you have discovered an “includes.php” file.</p><p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div>
</body>
</html>
