<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5.2 pspy2 – Unprivileged Linux Process Snooping</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">5.2 pspy2 – Unprivileged Linux Process Snooping</h1><br/><br />“pspy” is a command line tool designed to snoop on processes without need for root permissions. It allows you to see commands run by other users, cron jobs, etc. as they execute. Great for enumeration of Linux systems in CTFs. Also great to demonstrate your colleagues why passing secrets as arguments on the command line is a bad idea. More info <a href="https://www.jesusninoc.com/06/27/pspy-unprivileged-linux-process-snooping/">here</a>.<br /><br />1. Download “pspy32” from  <a href="https://github.com/DominicBreuker/pspy/releases/download/v1.0.0/pspy32">here</a>.<br /><br />2. Upload the file from the Kali Machine to “/tmp”.<br /><br />	<div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$scp</span>&nbsp;pspy32&nbsp;eric@192.168.12.41<span style="color:#a52a2a;font-weight:700">:/</span>tmp<br /></div></div><br /><br />3. Go to SSH connection shell.<br /><br />4. Change “pspy32” privileges.<span style="background-color:#000000;"><br /><br /></span>	<div class="codebox"><div class="codebox">eric@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span><span style="color:#6a5acd;font-weight:400">$cd</span>&nbsp;tmp&nbsp;<br />eric@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span>tmp$&nbsp;<span style="color:#a52a2a;font-weight:700">chmod</span>&nbsp;+x&nbsp;pspy32&nbsp;</div></div><span style="background-color:#000000;"><br /><br /></span>5. Run the script.<span style="background-color:#000000;"><br /><br /></span>	<div class="codebox"><div class="codebox">.<span style="color:#a52a2a;font-weight:700">/</span>pspy32</div></div><span style="background-color:#000000;"><br /><br /></span>	<span style="color:#ffa500;">Output:</span><br />	<img src="images/785-1.png" alt="images/785-1.png" /><br /><br />    There is a backup script running every minute.<br />    And there's also an “emergency” script.<br /><br />6. Look at the “backup.sh” script.<br />    <div class="codebox"><div class="codebox">eric@driftingblues<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$cat</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>var<span style="color:#a52a2a;font-weight:700">/</span>backups<span style="color:#a52a2a;font-weight:700">/</span>backup.sh</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/785-2.png" alt="images/785-2.png" /><br />   •  The backup.zip file which we saw earlier in the “linpeas.sh” enumeration is a result of this script. <br />   •  The developer has included a backdoor in the script. <br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>