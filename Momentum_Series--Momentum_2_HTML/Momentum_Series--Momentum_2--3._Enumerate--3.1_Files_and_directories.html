<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>3.1 Files and directories</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>3.1 Files and directories</h1><br/><br />If you visit the 192.168.12.23 URL you got nothing interesting.<br /><br />1. Enumerate information about the directories.<br /><br />	<div class="codebox"><div class="codebox"><span style="color:#0057ae;font-weight:400">$gobuster</span>&nbsp;dir&nbsp;-u&nbsp;http://192.168.12.23/&nbsp;-x&nbsp;html,txt,php,bak,php.bak&nbsp;--wordlist&nbsp;/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&nbsp;-o&nbsp;gobuster.log<br /></div></div><br /><br />Remember “php.bak” is also an extension.<br />	<span style="color:#ffa500;">Output:</span><br />	<a href=""><img src="images/532-1.png" alt="images/532-1.png" /></a><br /><br /><br />	We got some four intersting URIs were found from gobuster crawling result :<code> /ajax.php, /ajax.php.bak, /owls, /dashboard.html</code><br /><br />3. Open the <code>dashboard.html</code> page.<br /><br />	<a href=""><img src="images/532-2.png" alt="images/532-2.png" /></a><br /><br />	There&#39;s a file called “main.js”.<br />	<br />4. In the <code>js</code> directory there&#39;s a file called <code>main.js</code>. Open the file on your browser.<br />   <br />   <a href=""><img src="images/532-3.png" alt="images/532-3.png" /></a><br />   <br /><span style="indent:1;">It appears that this javascript file has an ajax post request in it to upload a file to an endpoint on the server called </span><code><span style="indent:1;">ajax.php</span></code><span style="indent:1;">  and that when the file is successfully uploaded, we’ll get a 1 in response.</span><br /><br />5. Let&#39;s see what the  <code>ajax.php.bak</code> file has.<br />	Visit <a href="http://192.168.12.23/ajax.php.bak.">http://192.168.12.23/ajax.php.bak.</a><br />	You can download the file and see its content.<br />	<br />	<div class="codebox"><div class="codebox">&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;//The&nbsp;boss&nbsp;told&nbsp;me&nbsp;to&nbsp;add&nbsp;one&nbsp;more&nbsp;Upper&nbsp;Case&nbsp;letter&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;cookie<br />&nbsp;&nbsp;&nbsp;if(isset($_COOKIE[&#39;admin&#39;])&nbsp;&amp;&amp;&nbsp;$_COOKIE[&#39;admin&#39;]&nbsp;==&nbsp;&#39;&amp;G6u@B6uDXMq&amp;Ms&#39;){<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//[+]&nbsp;Add&nbsp;if&nbsp;$_POST[&#39;secure&#39;]&nbsp;==&nbsp;&#39;val1d&#39;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$valid_ext&nbsp;=&nbsp;array(&quot;pdf&quot;,&quot;php&quot;,&quot;txt&quot;);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;else{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$valid_ext&nbsp;=&nbsp;array(&quot;txt&quot;);<br />&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;//&nbsp;Remember&nbsp;success&nbsp;upload&nbsp;returns&nbsp;1&nbsp;</div></div><br />	<br /><span style="indent:1;">In order to bypass the file upload filter, you needed to do two things;<br />• You needed to add a cookie named </span><code><span style="indent:1;">admin</span></code><span style="indent:1;"> with the value of </span><code><span style="indent:1;">&amp;G6u@B6uDXMq&amp;Ms</span></code><span style="indent:1;"> and some unknown character at the end of it<br />• You needed to add a post section named </span><code><span style="indent:1;">secure</span></code><span style="indent:1;"> that had a value of </span><code><span style="indent:1;">val1d</span></code>.<br /><br /><span style="indent:1;">Once you do these two things, then you can slip a php file onto the server. </span><br /><br /><p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>