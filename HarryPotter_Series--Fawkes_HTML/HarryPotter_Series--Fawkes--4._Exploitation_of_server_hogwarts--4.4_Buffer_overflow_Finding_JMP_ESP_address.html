<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>4.4 Buffer overflow: Finding JMP ESP address</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>4.4 Buffer overflow: Finding JMP ESP address</h1><br/><br /><strong>ESP – </strong>It is the stack  pointer. It indicates the location in the memory where the current  instruction starts. It always points to the top of the stack.<br /><br />When an access violation occurs, the ESP  register points to memory which contains the data which we had sent to the application. JMP ESP Instruction is used to redirect the code  execution to that location.  You have to use the “edb” application.<br /><br />1. Make sure ASLR is turned off on your Kali Machine.<br />	<div class="codebox"><div class="codebox"><span style="color:#0057ae;font-weight:400">$echo</span>&nbsp;0&nbsp;|&nbsp;sudo&nbsp;tee&nbsp;/proc/sys/kernel/randomize_va_space<br /></div></div><br />	<br />2. Close “gdb” and run the “server_hogwarts” on your Kali Machine.<br />	<div class="codebox"><div class="codebox">$./server_hogwarts&nbsp;</div></div><br /><br />3. Run “edb” on your Kali Machine and attach the “server_hogwarts” to it. <br />	<a href=""><img src="images/509-1.png" alt="images/509-1.png" /></a><br /><br />4. Run the program.<br />	<a href=""><img src="images/509-2.png" alt="images/509-2.png" /></a><br />	<br />5	To test everything is working fine, run over above python code (./overwritingEIP.py).<br />	<a href=""><img src="images/509-3.png" alt="images/509-3.png" /></a><br />	<br />6. Use “opcode search” plugin to find the JMP address.	 <br />	<a href=""><img src="images/509-4.png" alt="images/509-4.png" /></a><br /><br />8. Choose the highlighted line and the “ESP-&gt;EIP” option.<br />	<a href=""><img src="images/509-5.png" alt="images/509-5.png" /></a><br />	<br />7. Click on the “Find” button.<br />   <br />8. Write down the “Address” value.<br />	<a href=""><img src="images/509-6.png" alt="images/509-6.png" /></a><br /><br />	jmp_address=<strong>0x08049d55</strong><br />	<br />	<br />	<p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>