<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>4.2 pspy2 – Unprivileged Linux Process Snooping</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>4.2 pspy2 – Unprivileged Linux Process Snooping</h1><br/><br />“pspy” is a command line tool designed to snoop on processes without need for root permissions. It allows you to see commands run by other users, cron jobs, etc. as they execute. Great for enumeration of Linux systems in CTFs. Also great to demonstrate your colleagues why passing secrets as arguments on the command line is a bad idea. More info <a href="https://www.jesusninoc.com/06/27/pspy-unprivileged-linux-process-snooping/">here</a>.<br /><br />1. Download “pspy32” from .<br /><br />2. Upload the file from the Kali Machine to “/tmp”.<br /><br />	<div class="codebox"><div class="codebox"><span style="color:#0057ae;font-weight:400">$scp</span>&nbsp;pspy32&nbsp;angel@192.168.12.25:/tmp<br /></div></div><br /><br />3. Go to SSH connection shell.<br /><br />4. Change “pspy32” privileges.<span style="background-color:#000000;"><br /><br /></span>	<div class="codebox"><div class="codebox">angel@grotesque:/<span style="color:#0057ae;font-weight:400">$cd</span>&nbsp;/tmp<br />angel@grotesque:/tmp<span style="color:#0057ae;font-weight:400">$chmod</span>&nbsp;+x&nbsp;pspy32</div></div><span style="background-color:#000000;"><br /><br /></span>5. Run the script.<span style="background-color:#000000;"><br /><br /></span>	<div class="codebox"><div class="codebox">./pspy32</div></div><span style="background-color:#000000;"><br /><br /></span>	<span style="color:#ffa500;">Output:</span><br />	<a href=""><img src="images/567-1.png" alt="images/567-1.png" /></a><br /><br /><span style="indent:1;">It looks like there is a </span><strong><span style="indent:1;">check.sh</span></strong><span style="indent:1;"> file inside</span><strong><span style="indent:1;"> /root</span></strong><span style="indent:1;"> that runs every 1-2 minutes, but I don&#39;t know what it does. If we check the files inside the “quiet” directory we see that those files are owned by root:</span><br /><br />	<a href=""><img src="images/567-2.png" alt="images/567-2.png" /></a><br /><span style="background-color:#000000;"><br /><br /></span>6. Go to the “quiet” directory and delete all the files.<br />	<div class="codebox"><div class="codebox">angel@grotesque:~/quiet<span style="color:#0057ae;font-weight:400">$rm</span>&nbsp;-rf&nbsp;*<br /></div></div><br />	<br /><p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>