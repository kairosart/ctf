<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>5.1 pspy2 – Unprivileged Linux Process Snooping</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>5.1 pspy2 – Unprivileged Linux Process Snooping</h1><br/><br />“pspy” is a command line tool designed to snoop on processes without need for root permissions. It allows you to see commands run by other users, cron jobs, etc. as they execute. Great for enumeration of Linux systems in CTFs. Also great to demonstrate your colleagues why passing secrets as arguments on the command line is a bad idea. More info <a href="https://www.jesusninoc.com/06/27/pspy-unprivileged-linux-process-snooping/">here</a>.<br /><br />1. Download “pspy32” from .<br /><br />2. Upload the file from the Kali Machine to “/tmp”.<br /><br />	<div class="codebox"><div class="codebox"><span style="color:#0057ae;font-weight:400">$scp</span>&nbsp;pspy32&nbsp;hagrid98@192.168.12.19:/tmp</div></div><br /><br />3. Go to SSH connection shell.<br /><br />4. Change “pspy32” privileges.<span style="background-color:#000000;"><br /><br /></span>	<div class="codebox"><div class="codebox">chmod&nbsp;+x&nbsp;pspy32</div></div><span style="background-color:#000000;"><br /><br /></span>5. Run the script.<span style="background-color:#000000;"><br /><br /></span>	<div class="codebox"><div class="codebox">./pspy32</div></div><span style="background-color:#000000;"><br /><br /></span>	<span style="color:#ffa500;">Output:</span><br />	<a href=""><img src="images/468-1.png" alt="images/468-1.png" /></a><br /><br /><span style="indent:1;">After executing the script, we found a python script “backup.sh” which could be on cronjob with root privileges which we can exploit for privilege escalation.</span><span style="background-color:#000000;"><br /><br /></span>6. Look for the script.<br />	<div class="codebox"><div class="codebox">hagrid98@Aragog:~<span style="color:#0057ae;font-weight:400">$ls</span>&nbsp;-lah&nbsp;/opt</div></div><br />	<br />	<span style="color:#ffa500;">Output:</span><br />	<a href=""><img src="images/468-2.png" alt="images/468-2.png" /></a><br />	<br />	So, “backup.sh” is owned by the user we’re logged in as.<span style="background-color:#000000;"><br /><br /><br /><br /></span><p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>