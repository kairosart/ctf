<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>3.1 php pseudo-protocol</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">3.1 php pseudo-protocol</h1><br/><br /><strong>Definition of pseudo-protocol</strong><br />Something that can be accessed in the manner of a <a href="https://en.wiktionary.org/wiki/protocol">protocol</a> but is not in fact a protocol.<br /><br /><strong>php://filter</strong>(usually can be used to read any file)<br /><br />    To read the source file of class.php.<br /><br />    Usage introduction: php://filter indicates the protocol type used, and read=&lt;filter name used to read the data link&gt;  separated by/.<br /><br />    The code is: <code>file=php://filter/read=convert.base64-encode/resource=class.php</code><br /><br />    Resource=class.php indicates that the file stream to be read is the class.php file.<br /><br />    Read=convert.base64-encode, a conversion filter is used to encode the string according to base64.<br /><br />1. Visit <a href="http://juggling.hmv//blog.php?page=php://filter/read=convert.base64-encode/resource=index.">http://juggling.hmv/blog.php?page=php://filter/read=convert.base64-encode/resource=index.</a><br />    <br />2. Right-click and choose “View source code” and you'll see the “index” base64 encoded file.<br />    <img src="images/950-1.png" alt="images/950-1.png" /><br /><br />3. On your Kali Machine decode the file.<br />    <div class="codebox"><div class="codebox">$&nbsp;<span style="color:#a52a2a;font-weight:700">echo</span>&nbsp;&lt;your&nbsp;code&gt;&nbsp;<span style="color:#a52a2a;font-weight:700">|</span>&nbsp;base64&nbsp;-d</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/950-2.png" alt="images/950-2.png" /><br /><br />    You can see there's a file “../s3cur3/index.php”.<br />    <br />4. Open “Burp suite” and intercept with “Proxy” the following URL  <a href="http://juggling.hmv//blog.php?page=php://filter/read=convert.base64-encode/resource=index.">http://juggling.hmv/blog.php?page=php://filter/read=convert.base64-encode/resource=index</a>.<br />   <img src="images/950-3.png" alt="images/950-3.png" /> <br /><br />5. Send it to “Burp Repeater”.<br />   <br />6. Change “index” to “..%2fs3cur3%2findex”.<br />   <img src="images/950-4.png" alt="images/950-4.png" /><br /><br />7. Send the request.<br />    <img src="images/950-5.png" alt="images/950-5.png" /><br />   <br />   You'll see a base64 encode string.<br /><br />8. In “Burp Suite” open the “Inspector”, select the entire string and you'll see the decoded code.<br />   <img src="images/950-6.png" alt="images/950-6.png" /><br />   <br />   This code is the “index.php” file..<br /><br />    You can see in the <code>eval</code> line that you can post a value called <code>system</code>. This value is your attack's URL.  <br /><br /><br /><br />    </div></body></html>