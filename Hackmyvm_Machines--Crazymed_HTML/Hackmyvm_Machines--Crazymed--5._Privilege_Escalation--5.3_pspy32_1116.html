<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5.3 pspy32</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>5.3 pspy32</h1><br/><p></p><p>1. Run the following on the victim&#39;s machine.</p><p>    <div class="codebox"><pre>brad@crazymed<span style="color:#a52a2a;font-weight:700">:</span>~$ .<span style="color:#a52a2a;font-weight:700">/</span>pspy32 </pre></div></p><p>   </p><p>    <span style="color:#ffa500;">Output:</span>    </p><p>    <img src="images/1116-1.png" alt="images/1116-1.png" /></p><p>   </p><p>    These lines are interesting.</p><p></p><p>2. Take a look at that script.</p><p>    <div class="codebox"><pre>brad@crazymed<span style="color:#a52a2a;font-weight:700">:</span>~$ <span style="color:#a52a2a;font-weight:700">cat</span> <span style="color:#a52a2a;font-weight:700">/</span>opt<span style="color:#a52a2a;font-weight:700">/</span>check_VM </pre></div> </p><p>   </p><p>   <div class="codebox"><pre><span style="color:#0000ff;font-weight:700">#! /bin/bash</span><br /><br /><span style="color:#0000ff;font-weight:400">#users flags</span><br /><span style="color:#6a5acd;font-weight:400">flags</span>=<span style="color:#a52a2a;font-weight:700">(/</span>root<span style="color:#a52a2a;font-weight:700">/</span>root.txt <span style="color:#a52a2a;font-weight:700">/</span>home<span style="color:#a52a2a;font-weight:700">/</span>brad<span style="color:#a52a2a;font-weight:700">/</span>user.txt<span style="color:#a52a2a;font-weight:700">)</span><br /><span style="color:#a52a2a;font-weight:700">for</span> <span style="color:#6a5acd;font-weight:400">x</span> <span style="color:#a52a2a;font-weight:700">in</span> <span style="color:#ff00ff;font-weight:400">&quot;${flags[@]}&quot;</span><br /><span style="color:#a52a2a;font-weight:700">do</span><br /><span style="color:#a52a2a;font-weight:700">if</span> [[ <span style="color:#a52a2a;font-weight:700">!</span> -f <span style="color:#6a5acd;font-weight:400">$x</span> ]] <span style="color:#a52a2a;font-weight:700">;</span> <span style="color:#a52a2a;font-weight:700">then</span><br /><span style="color:#a52a2a;font-weight:700">echo</span> <span style="color:#ff00ff;font-weight:400">&quot;$x doesn&#39;t exist&quot;</span><br />mcookie &gt; <span style="color:#6a5acd;font-weight:400">$x</span><br /><span style="color:#a52a2a;font-weight:700">chmod</span> 700 <span style="color:#6a5acd;font-weight:400">$x</span><br /><span style="color:#a52a2a;font-weight:700">fi</span><br /><span style="color:#a52a2a;font-weight:700">done</span><br /><br /><span style="color:#a52a2a;font-weight:700">chown</span> -R www-data<span style="color:#a52a2a;font-weight:700">:</span>www-data <span style="color:#a52a2a;font-weight:700">/</span>var<span style="color:#a52a2a;font-weight:700">/</span>www<span style="color:#a52a2a;font-weight:700">/</span>html<br /><br /><span style="color:#0000ff;font-weight:400">#bash_history =&gt; /dev/null</span><br /><span style="color:#6a5acd;font-weight:400">home</span>=$<span style="color:#a52a2a;font-weight:700">(cat</span> <span style="color:#a52a2a;font-weight:700">/</span>etc<span style="color:#a52a2a;font-weight:700">/passwd</span> <span style="color:#a52a2a;font-weight:700">|grep</span> <span style="color:#a52a2a;font-weight:700">bash</span> <span style="color:#a52a2a;font-weight:700">|awk</span> -F<span style="color:#a52a2a;font-weight:700">:</span> <span style="color:#ff00ff;font-weight:400">&#39;{print $6}&#39;</span><span style="color:#a52a2a;font-weight:700">)</span><br /><br /><span style="color:#a52a2a;font-weight:700">for</span> <span style="color:#6a5acd;font-weight:400">x</span> <span style="color:#a52a2a;font-weight:700">in</span> <span style="color:#6a5acd;font-weight:400">$home</span><br /><span style="color:#a52a2a;font-weight:700">do</span><br /><span style="color:#a52a2a;font-weight:700">ln</span> -sf <span style="color:#a52a2a;font-weight:700">/</span>dev<span style="color:#a52a2a;font-weight:700">/</span>null <span style="color:#6a5acd;font-weight:400">$x</span><span style="color:#a52a2a;font-weight:700">/</span>.bash_history <span style="color:#a52a2a;font-weight:700">;</span> eccho <span style="color:#ff00ff;font-weight:400">&quot;All&#39;s fine !&quot;</span><br /><span style="color:#a52a2a;font-weight:700">done</span><br /><br /><br /><span style="color:#a52a2a;font-weight:700">find</span> <span style="color:#a52a2a;font-weight:700">/</span>var<span style="color:#a52a2a;font-weight:700">/</span>log -name <span style="color:#ff00ff;font-weight:400">&quot;*.log*&quot;</span> -exec <span style="color:#a52a2a;font-weight:700">rm</span> -f <span style="color:#a52a2a;font-weight:700">{}</span> +<br /></pre></div></p><p>   </p><p>   The interesting line is “<strong><span style="color:#a52a2a;">chown</span></strong> -R www-data<strong><span style="color:#a52a2a;">:</span></strong>www-data <strong><span style="color:#a52a2a;">/</span></strong>var<strong><span style="color:#a52a2a;">/</span></strong>www<strong><span style="color:#a52a2a;">/</span></strong>html”.</p><p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div>
</body>
</html>
