<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>5.4 PATH HIJACKING</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>5.4 PATH HIJACKING</h1><br/><p></p><p>1. On the victim&#39;s machine create a file called “chown” with a malice content to assign SUID to /bin/bash.</p><p>    <div class="codebox"><pre>brad@crazymed<span style="color:#a52a2a;font-weight:700">:</span>~$ <span style="color:#a52a2a;font-weight:700">echo</span> <span style="color:#ff00ff;font-weight:400">&quot;chmod u+s /bin/bash&quot;</span> &gt; <span style="color:#a52a2a;font-weight:700">/</span>usr<span style="color:#a52a2a;font-weight:700">/</span>local<span style="color:#a52a2a;font-weight:700">/</span>bin<span style="color:#a52a2a;font-weight:700">/chown</span><br />brad@crazymed<span style="color:#a52a2a;font-weight:700">:</span>~$ <span style="color:#a52a2a;font-weight:700">chmod</span> +x <span style="color:#a52a2a;font-weight:700">/</span>usr<span style="color:#a52a2a;font-weight:700">/</span>local<span style="color:#a52a2a;font-weight:700">/</span>bin<span style="color:#a52a2a;font-weight:700">/chown</span></pre></div></p><p></p><p>   The SetUID bit enforces user ownership on an executable file. When it is set, the file will execute with the file owner&#39;s user ID, not the person running it.</p><p></p><p>    $ chmod u+s</p><p>    </p><p>        </p><p>2. Run the following command on the victim&#39;s machine.</p><p>    <div class="codebox"><pre>brad@crazymed<span style="color:#a52a2a;font-weight:700">:</span>~$ <span style="color:#a52a2a;font-weight:700">/</span>bin<span style="color:#a52a2a;font-weight:700">/bash</span> -p<br /></pre></div></p><p></p><p><span style="indent:1;">The -p option in bash is related to security. It is used to prevent the shell reading user-controlled files.</span></p><p></p><p><span style="indent:1;">The </span><a href="https://www.gnu.org/software/bash/manual/bash.html#Bash-Startup-Files">bash</a><span style="indent:1;"> manual says:</span></p><p><span style="indent:1;">Invoked with unequal effective and real uid/gids</span></p><p><span style="indent:1;">If Bash is started with the effective user (group) id not equal to the real user (group) id, and the -p option is not supplied, no startup files are read, shell functions are not inherited from the environment, the SHELLOPTS, BASHOPTS, CDPATH, and GLOBIGNORE variables, if they appear in the environment, are ignored, and the effective user id is set to the real user id. If the -p option is supplied at invocation, the startup behavior is the same, but the effective user id is not reset.</span></p><p>    </p><p>    <span style="color:#ffa500;">Output:</span></p><p>    <img src="images/1117-1.png" alt="images/1117-1.png" /></p><p align="center"><img src="images/home.svg" height="22" width="22">  <a href="index.html">Index</a></p></div>
</body>
</html>
