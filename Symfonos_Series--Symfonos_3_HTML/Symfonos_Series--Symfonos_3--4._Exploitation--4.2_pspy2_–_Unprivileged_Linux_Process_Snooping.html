<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>4.2 pspy2 – Unprivileged Linux Process Snooping</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><h1><b><u>4.2 pspy2 – Unprivileged Linux Process Snooping</u></b></h1><br />“pspy” is a command line tool designed to snoop on processes without need for root permissions. It allows you to see commands run by other users, cron jobs, etc. as they execute. Great for enumeration of Linux systems in CTFs. Also great to demonstrate your colleagues why passing secrets as arguments on the command line is a bad idea. More info <a href="https://www.jesusninoc.com/06/27/pspy-unprivileged-linux-process-snooping/">here</a>.<br /><br />a) Download “pspy32” from <a href="https://github.com/DominicBreuker/pspy/releases/download/v1.0.0/pspy32">here</a>.<br /><br />b) Upload the file from the meterpreter to “/tmp”.<br /><br /><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;<span style="color:#ff9d00;font-weight:700">cd</span>&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>tmp<br />meterpreter&nbsp;&gt;&nbsp;upload&nbsp;pspy32</div></div><br /><br />c) Run the following commands.<br /><br /><div class="codebox"><div class="codebox">meterpreter&nbsp;&gt;&nbsp;shell<br />python&nbsp;-c&nbsp;<span style="color:#3ad900;font-weight:400">'import&nbsp;pty;pty.spawn("/bin/bash")'</span><br /></div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><span style="background-color:#000000;">cerberus@symfonos3:/tmp$ <br /><br />d) Change “pspy32” privileges.<br /><br /></span><div class="codebox"><div class="codebox">cerberus@symfonos3<span style="color:#ff9d00;font-weight:700">:/</span>tmp<span style="color:#7f0044;font-weight:400">$chmod</span>&nbsp;777&nbsp;pspy32</div></div><br /><br />e) Run the script.<br /><br /><div class="codebox"><div class="codebox">cerberus@symfonos3<span style="color:#ff9d00;font-weight:700">:/</span>tmp$.<span style="color:#ff9d00;font-weight:700">/</span>pspy32</div></div><br /><br /><span style="color:#ffa500;">Output:</span><br /><img src="images/395-1.png" alt="images/395-1.png" /><br /><br />After executing the script, we found a python script “ftpclient.py” which could be on cronjob with root privileges which we can exploit for privilege escalation.<span style="background-color:#000000;"><br /><br /><br /></span><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Index</a></p></body></html>